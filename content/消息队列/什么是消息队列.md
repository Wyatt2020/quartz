---
created: 2023-06-27 16:57
modified: 2024-07-06 19:01
tags: [消息队列]
cssclasses:
  - wiki-page
---

### 什么是消息队列

MQ（Message Quene）通过典型的生产者和消费者模型，生产者不断向消息队列中产生消息，消费者不断的从队列中获取消息。因为生产者和消费者都是异步的，而且生产者只关心消息的发送，消费者只关心消息的接收，没有业务逻辑的侵入，轻松实现业务解耦。

### 消息队列有什么用

#### 异步处理

场景描述：某商场具有注册功能，注册的时候需要发送短信验证码。

传统的做法是用户提交信息到用户服务，用户服务调用短信服务发送短信，然后给用户返回响应，这种是同步的处理方式，耗时较长。加入消息队列后，用户直接提交信息到用户服务，将信息写入消息队列，直接给用户返回响应，短信服务从消息队列中读取消息进行发送短信。

#### 应用解耦

场景描述：某商场下单流程。

传统做法是用户下单，订单系统去查询库存系统，如果库存系统宕机了，则下单失败，损失订单量。加入消息队列后，用户下单，订单系统记录订单，将订单信息写入消息队列，下单成功，然后库存系统恢复正常后去操作数据库库存（不考虑库存为 0 的情况）。这样订单系统和库存系统就达到松耦合的目的了

#### 流量削峰

场景描述：秒杀活动。

流量过大肯定会导致响应超时或系统宕机，加入消息队列，用户秒杀请求写入消息队列，设置消息队列的长度等属性，达到消息队列最大长度后，直接返回秒杀失败，然后再去消费消息队列的数据，完成秒杀。
